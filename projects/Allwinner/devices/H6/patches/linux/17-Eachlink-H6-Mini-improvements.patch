From 435989a52d15535e15622f374f50041bab1cd424 Mon Sep 17 00:00:00 2001
From: Andreas Baierl <ichgeh@imkreisrum.de>
Date: Mon, 23 Mar 2020 11:25:38 +0100
Subject: [PATCH] arm64: dts: allwinner: Eachlink H6 Mini improvements

Signed-off-by: Andreas Baierl <ichgeh@imkreisrum.de>
---
 .../allwinner/sun50i-h6-eachlink-h6mini.dts   | 48 +++++++++++++++++++
 1 file changed, 48 insertions(+)

diff --git a/arch/arm64/boot/dts/allwinner/sun50i-h6-eachlink-h6mini.dts b/arch/arm64/boot/dts/allwinner/sun50i-h6-eachlink-h6mini.dts
index 2c67f5607120..c8f6e0abb1d9 100644
--- a/arch/arm64/boot/dts/allwinner/sun50i-h6-eachlink-h6mini.dts
+++ b/arch/arm64/boot/dts/allwinner/sun50i-h6-eachlink-h6mini.dts
@@ -12,6 +12,7 @@
 	compatible = "eachlink,h6-mini", "allwinner,sun50i-h6";
 
 	aliases {
+		ethernet0 = &emac;
 		serial0 = &uart0;
 	};
 
@@ -31,6 +32,13 @@
 		};
 	};
 
+	reg_vcc1v8: vcc1v8 {
+		compatible = "regulator-fixed";
+		regulator-name = "vcc1v8";
+		regulator-min-microvolt = <1800000>;
+		regulator-max-microvolt = <1800000>;
+	};
+
 	reg_vcc3v3: vcc3v3 {
 		compatible = "regulator-fixed";
 		regulator-name = "vcc3v3";
@@ -39,6 +47,10 @@
 	};
 };
 
+&ac200_pwm_clk {
+	status = "okay";
+};
+
 &de {
 	status = "okay";
 };
@@ -47,6 +59,14 @@
 	status = "okay";
 };
 
+&emac {
+	pinctrl-names = "default";
+	pinctrl-0 = <&ext_rmii_pins>;
+	phy-mode = "rmii";
+	phy-handle = <&ext_rmii_phy>;
+	status = "okay";
+};
+
 &ehci0 {
 	status = "okay";
 };
@@ -69,6 +89,17 @@
 	};
 };
 
+&i2c3 {
+	status = "okay";
+};
+
+&mdio {
+	ext_rmii_phy: ethernet-phy@1 {
+		compatible = "ethernet-phy-ieee802.3-c22";
+		reg = <1>;
+	};
+};
+
 &mmc0 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&mmc0_pins>;
@@ -78,6 +109,15 @@
 	status = "okay";
 };
 
+&mmc2 {
+	vmmc-supply = <&reg_vcc3v3>;
+	vqmmc-supply = <&reg_vcc1v8>;
+	non-removable;
+	cap-mmc-hw-reset;
+	bus-width = <8>;
+	status = "okay";
+};
+
 &ohci0 {
 	status = "okay";
 };
@@ -86,6 +126,14 @@
 	status = "okay";
 };
 
+&pio {
+	vcc-pc-supply = <&reg_vcc1v8>;
+};
+
+&pwm {
+	status = "okay";
+};
+
 &r_ir {
 	linux,rc-map-name = "rc-eachlink-h6mini";
 	status = "okay";
-- 
2.20.1

